<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <title>manage-demo</title>
  <link rel="stylesheet" href="./css/pure.min.css">
  <link rel="stylesheet" href="./css/fontello.css">
  <link rel="stylesheet" href="./css/reboto/roboto.css">
  <link rel="stylesheet" href="./css/main.css">
</head>
<body>
  <div class="content">
      <header class="header">
        <a class="logo" href="/"><i class="icon-header"></i><h1>Manage-Demo</h1></a>
        <div class="header-right">
          <ul>
            <li class="msg">
              <div>
                <i class="icon-mail"></i>
                <span class="count">10</span>
              </div>
              <div class="detail msg-detail">
                <header>you had receive 10 message</header>
                <ul>
                  <li><a href="javascript:;">aaaaaa</a></li>
                  <li><a href="javascript:;">bbbbbbb</a></li>
                  <li><a href="javascript:;">ccccccc</a></li>
                  <li><a href="javascript:;">aaaaaa</a></li>
                  <li><a href="javascript:;">bbbbbbb</a></li>
                  <li><a href="javascript:;">ccccccc</a></li>
                  <li><a href="javascript:;">aaaaaa</a></li>
                  <li><a href="javascript:;">bbbbbbb</a></li>
                  <li><a href="javascript:;">ccccccc</a></li>
                  <li><a href="javascript:;">aaaaaa</a></li>
                  <li><a href="javascript:;">bbbbbbb</a></li>
                  <li><a href="javascript:;">ccccccc</a></li>
                </ul>
                <footer>
                  <a href="javascript:;">view all messeage</a>
                </footer>
              </div>
            </li><li class="profile">
            <div class="avatar">
              <img src="./img/me.jpg" alt="">
            </div>
            <span class="user-name">Jeff Zhong</span>
            <div class="detail user-detail">
              <div class="con">
                <div class="avatar"><img src="img/me.jpg" alt=""></div>
                <a class="user-link" href="https://github.com/edwardzhong/">Jeff Zhong</a>
                <p>Web developer</p>
              </div>
              <footer class="clearfix">
                <a class="fl" href="javascript:;">Profile</a>
                <a class="fr" href="./sign.html">Sign out</a>
              </footer>
            </div>
          </li>
        </ul>
      </div>
      <div class="header-middle">
        <a id="pushMenu"class="push-menu" href="javascript:;"><i class="icon-menu"></i></a>
      </div>
    </header>
    <aside class="menu-wrap">
      <ul id="menuList" class="side-menu">
        <li>
          <a title="Vue Sample" href="./pages/home.html"><i class="icon-code"></i><span>Vue Sample</span></a>
        </li>
        <li class="children">
          <a title="Html Component" href="javascript:;"><i class="icon-doc-text"></i><span>Html Component</span></a>
          <ul>
            <li>
              <a title="Grid" href="./pages/grid.html"><span> Grid</span></a>
            </li>
            <li>
              <a title="Button" href="./pages/button.html"><span> Button</span></a>
            </li>
            <li>
              <a title="Form" href="./pages/form.html"><span> Form</span></a>
            </li>
            <li>
              <a title="Dialog" href="./pages/dialog.html"><span> Dialog</span></a>
            </li>
            <li>
              <a title="Table" href="./pages/table.html"><span> Table</span></a>
            </li>
            <li>
              <a title="Menu" href="./pages/menu.html"><span> Menu</span></a>
            </li>
            <li>
              <a title="Other" href="./pages/other.html"><span> Other</span></a>
            </li>
          </ul>
        </li>
        <li>
          <a title="Graph" href="./pages/graph.html"><i class="icon-picture"></i><span> Graph</span></a>
        </li>
      </ul>
    </aside>
    <div id="main" class="main">
      <nav class="nav">
        <ul id="nav" class="menu-tabs"></ul>
      </nav>
      <div class="page-con"></div>
    </div>
    <footer class="footer">
      <p>All content copyright <a href="/about">Jeff Zhong</a>&nbsp;&nbsp;&copy; 2017. All rights reserved.</p>
    </footer>
  </div>
<script src="./js/jquery.min.js"></script>
<script>
    // 导航栏隐藏／显示
    $('#pushMenu').on('click',function(){
      $('.content').toggleClass('hide-nav');
    });
    
    /**
     * set page container scroll
     */
    function setHeight(){
      var winHeight=$(window).height(),
          headerHeight=$('.header').height(),
          footerHeight=$('.footer').height(),
          navHeight=$('.nav').outerHeight();
      $('.page-con').height(winHeight-headerHeight-navHeight-footerHeight);
    }
    setHeight();
    $(window).on('resize',setHeight);

    //存在则激活tab, 否则新建tab 
    function clickMenu(url,txt){
      var i=-1;
      $('#nav li').each(function(index, el) {
        if($(this).attr('data-txt')==txt){
          i=index;
          return false;
        }
      });
      if(i>-1){
        selectTab(i);
      } else {
        appendTab(txt);
        appendPage(url);        
      }
    }

    function appendPage(url){
      $('.page-con .page').removeClass('active');
      $('.page-con').append('<div class="page active"><iframe src="'+url+'" frameborder="0" width="100%" height="100%"></iframe></div>');
    }

    function appendTab(txt){
      $('#nav li').removeClass('active');
      $('#nav').append('<li data-txt="'+txt+'" class="active"><a href="javascript:;">'+txt+'<i class="close">×</i></a></li>');
    }

    function selectNext(i){
      var len=$('#nav li').length;
      if(len<=1) return;
      selectTab(i>0?i-1:i+1);
    }

    function selectTab(index){
      $('#nav li').eq(index).addClass('active').siblings('.active').removeClass('active');
      $('.page-con .page').eq(index).addClass('active').siblings('.active').removeClass('active');
    }

    // 选择导航菜单
    $('#menuList').on('click','a',function(e){
      e.preventDefault();
      var $li=$(this).parent();
      if($li.hasClass('children')&&$li.hasClass('active')){
        $li.removeClass('active');
        return;
      }
      $li.addClass('active').siblings('.active').removeClass('active');
      if($li.hasClass('children')) return;
      var url=$(this).attr('href'),
          txt=$.trim($(this).find('span').html());
      clickMenu(url,txt);
    });

    // 选择tab
    $('#nav').on('click','li',function(){
      if($(this).hasClass('active')) return;
      var index =$(this).index();
      selectTab(index);
    });

    // 关闭tab
    $('#nav').on('click','.close',function(e){
      e.preventDefault();
      e.stopPropagation();
      var $li=$(this).parent().parent(),
          index =$li.index();
      if($li.hasClass('active')){
        selectNext(index);
      }
      $li.remove();
      $('.page-con .page').eq(index).remove();
    });

    $('#menuList a').first().click();
</script>
</body>
</html>
