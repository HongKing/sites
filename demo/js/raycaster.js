(function(){'use strict';var Te=Math.floor,Ee=Math.sin,ye=Math.cos,be=Math.PI,ge=Math.sqrt;function e(e,t,i){const r=new Ae(3);return e&&(r[0]=e),t&&(r[1]=t),i&&(r[2]=i),r}function t(e,t,i){return i=i||new Ae(3),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i}function i(e,t,i){return i=i||new Ae(3),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i}function r(e,t,i){i=i||new Ae(3);const r=e[2]*t[0]-e[0]*t[2],n=e[0]*t[1]-e[1]*t[0];return i[0]=e[1]*t[2]-e[2]*t[1],i[1]=r,i[2]=n,i}function n(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function o(e){return ge(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function a(e,t){t=t||new Ae(3);const i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=ge(i);return 1e-5<r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=0,t[1]=0,t[2]=0),t}function s(e,t){return t=t||new Ae(3),t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function u(e){return e=e||new Se(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function l(e,t){t=t||new Se(16);const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],_=e[9],m=e[10],f=e[11],p=e[12],h=e[13],v=e[14],x=e[15],T=m*x,E=v*f,y=u*x,A=v*l,S=u*f,z=m*l,L=n*x,R=v*o,C=n*f,N=m*o,I=n*l,O=u*o,F=c*h,B=p*_,V=a*h,P=p*s,D=a*_,w=c*s,M=i*h,U=p*r,G=i*_,k=c*r,X=i*s,W=a*r,Y=T*s+A*_+S*h-(E*s+y*_+z*h),H=E*r+L*_+N*h-(T*r+R*_+C*h),j=y*r+R*s+I*h-(A*r+L*s+O*h),q=z*r+C*s+O*_-(S*r+N*s+I*_),K=1/(i*Y+a*H+c*j+p*q);return t[0]=K*Y,t[1]=K*H,t[2]=K*j,t[3]=K*q,t[4]=K*(E*a+y*c+z*p-(T*a+A*c+S*p)),t[5]=K*(T*i+R*c+C*p-(E*i+L*c+N*p)),t[6]=K*(A*i+L*a+O*p-(y*i+R*a+I*p)),t[7]=K*(S*i+N*a+I*c-(z*i+C*a+O*c)),t[8]=K*(F*l+P*f+D*x-(B*l+V*f+w*x)),t[9]=K*(B*o+M*f+k*x-(F*o+U*f+G*x)),t[10]=K*(V*o+U*l+X*x-(P*o+M*l+W*x)),t[11]=K*(w*o+G*l+W*f-(D*o+k*l+X*f)),t[12]=K*(V*m+w*v+B*u-(D*v+F*u+P*m)),t[13]=K*(G*v+F*n+U*m-(M*m+k*v+B*n)),t[14]=K*(M*u+W*v+P*n-(X*v+V*n+U*u)),t[15]=K*(X*m+D*n+k*u-(G*u+W*m+w*n)),t}function d(e,t,i){i=i||new Se(16);const r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],d=e[7],c=e[8],_=e[9],m=e[10],f=e[11],p=e[12],h=e[13],v=e[14],x=e[15],T=t[0],E=t[1],y=t[2],A=t[3],S=t[4],z=t[5],L=t[6],R=t[7],C=t[8],N=t[9],I=t[10],O=t[11],F=t[12],B=t[13],V=t[14],P=t[15];return i[0]=r*T+s*E+c*y+p*A,i[1]=n*T+u*E+_*y+h*A,i[2]=o*T+l*E+m*y+v*A,i[3]=a*T+d*E+f*y+x*A,i[4]=r*S+s*z+c*L+p*R,i[5]=n*S+u*z+_*L+h*R,i[6]=o*S+l*z+m*L+v*R,i[7]=a*S+d*z+f*L+x*R,i[8]=r*C+s*N+c*I+p*O,i[9]=n*C+u*N+_*I+h*O,i[10]=o*C+l*N+m*I+v*O,i[11]=a*C+d*N+f*I+x*O,i[12]=r*F+s*B+c*V+p*P,i[13]=n*F+u*B+_*V+h*P,i[14]=o*F+l*B+m*V+v*P,i[15]=a*F+d*B+f*V+x*P,i}function c(e,t,i,r,n){var o=Math.tan;n=n||new Se(16);const a=o(.5*be-.5*e),s=1/(i-r);return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(i+r)*s,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*(i*r*s),n[15]=0,n}function _(e,i,n,o){o=o||new Se(16);const s=ze,u=Le,l=Re;return a(t(e,i,l),l),a(r(n,l,s),s),a(r(l,s,u),u),o[0]=s[0],o[1]=s[1],o[2]=s[2],o[3]=0,o[4]=u[0],o[5]=u[1],o[6]=u[2],o[7]=0,o[8]=l[0],o[9]=l[1],o[10]=l[2],o[11]=0,o[12]=e[0],o[13]=e[1],o[14]=e[2],o[15]=1,o}function m(e,t){return t=t||new Se(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function f(e,t,i){i=i||new Se(16);const r=t[0],n=t[1],o=t[2],a=e[0],s=e[1],u=e[2],l=e[3],d=e[4],c=e[5],_=e[6],m=e[7],f=e[8],p=e[9],h=e[10],v=e[11],x=e[12],T=e[13],E=e[14],y=e[15];return e!==i&&(i[0]=a,i[1]=s,i[2]=u,i[3]=l,i[4]=d,i[5]=c,i[6]=_,i[7]=m,i[8]=f,i[9]=p,i[10]=h,i[11]=v),i[12]=a*r+d*n+f*o+x,i[13]=s*r+c*n+p*o+T,i[14]=u*r+_*n+h*o+E,i[15]=l*r+m*n+v*o+y,i}function p(e,t){t=t||new Se(16);const i=ye(e),r=Ee(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h(e,t,i,r){r=r||new Se(16);let o=t[0],a=t[1],u=t[2];const l=ge(o*o+a*a+u*u);o/=l,a/=l,u/=l;const n=o*o,d=a*a,_=u*u,m=ye(i),c=Ee(i),s=1-m,f=n+(1-n)*m,p=o*a*s+u*c,h=o*u*s-a*c,v=o*a*s-u*c,T=d+(1-d)*m,E=a*u*s+o*c,A=o*u*s+a*c,S=a*u*s-o*c,L=_+(1-_)*m,R=e[0],C=e[1],N=e[2],I=e[3],O=e[4],F=e[5],B=e[6],V=e[7],P=e[8],D=e[9],w=e[10],M=e[11];return r[0]=f*R+p*O+h*P,r[1]=f*C+p*F+h*D,r[2]=f*N+p*B+h*w,r[3]=f*I+p*V+h*M,r[4]=v*R+T*O+E*P,r[5]=v*C+T*F+E*D,r[6]=v*N+T*B+E*w,r[7]=v*I+T*V+E*M,r[8]=A*R+S*O+L*P,r[9]=A*C+S*F+L*D,r[10]=A*N+S*B+L*w,r[11]=A*I+S*V+L*M,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r}function v(t,i,r){r=r||e();const n=i[0],o=i[1],a=i[2],s=n*t[3]+o*t[7]+a*t[11]+t[15];return r[0]=(n*t[0]+o*t[4]+a*t[8]+t[12])/s,r[1]=(n*t[1]+o*t[5]+a*t[9]+t[13])/s,r[2]=(n*t[2]+o*t[6]+a*t[10]+t[14])/s,r}function x(t,i,r){r=r||e();const n=i[0],o=i[1],a=i[2];return r[0]=n*t[0]+o*t[4]+a*t[8],r[1]=n*t[1]+o*t[5]+a*t[9],r[2]=n*t[2]+o*t[6]+a*t[10],r}function T(){var e=Te(360*Math.random()),t=Te(50*Math.random()+50),i=Te(20*Math.random()+40);return[e,t,i]}function E(e){var n=Math.ceil,o=parseFloat(e[0]/360,10),a=parseFloat(e[1]/100,10),s=parseFloat(e[2]/100,10);if(0==a){var u=g=b=n(255*s);return[u,g,b]}for(var r,l=.5<=s?s+a-s*a:s*(1+a),d=2*s-l,c=[1/3,0,-1/3],_=0;3>_;_++)r=o+c[_],0>r&&(r+=1),1<r&&(r-=1),r=1>6*r?d+6*(l-d)*r:1>2*r?l:2>3*r?d+6*((l-d)*(2/3-r)):d,c[_]=n(255*r);return c}function y(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]||1]}function A(e,t,i){if(!e)throw new Error("canvas not exist");var r=e.getBoundingClientRect();return{x:(t-r.left)*(e.width/r.width),y:(i-r.top)*(e.height/r.height)}}function S(e,t,i){if(!e)throw new Error("canvas not exist");var r=e.getBoundingClientRect(),n=e.width,o=e.height,a=(t-r.left)*(n/r.width),s=(i-r.top)*(o/r.height);return{x:(a-n/2)/(n/2),y:(o/2-s)/(o/2)}}function z(e,t){t=t||window.devicePixelRatio;var i=e.width,r=e.height,n=Te(e.clientWidth*t),o=Te(e.clientHeight*t);(i!==n||r!==o)&&(e.width=n,e.height=o,e.style.width=i+"px",e.style.height=r+"px")}function L(e,t){var i="mousewheel";try{document.createEvent("MouseScrollEvents"),i="DOMMouseScroll"}catch(t){}e.addEventListener(i,function(i){if("wheelDelta"in i){var e=i.wheelDelta;window.opera&&10>opera.version()&&(e=-e),i.delta=Math.round(e)/120}else"detail"in i&&(i.wheelDelta=40*-i.detail,i.delta=i.wheelDelta/120);t(i)},!1)}function R(t,r,u,l){function d(i){var e=Math.acos,r=A(t,i.clientX,i.clientY),o=2*((E.y>T.y?E.x-r.x:r.x-E.x)/m*be),u=(E.y-r.y)/f*be,l=z[1],d=e(n(a(z),a([0,l,0]))),c=p(o);d+u<be/90&&0<l&&0>u&&(u=be/180-d),d-u<be/90&&0>l&&0<u&&(u=d-be/180);var _=x(p(-be/2),[z[0],0,z[2]]),y=h(c,_,-u);S=s(v(y,z))}function c(){z=s(S),t.removeEventListener("mouseup",c,!1),t.removeEventListener("mousemove",d,!1),t.removeEventListener("mouseout",c,!1)}if(!t)throw new Error("canvas not exist");r=r||[0,5,5],u=u||1,l=l||50;var _,m=t.clientWidth,f=t.clientHeight,T={x:m/2,y:f/2},E=T,y=1,S=r,z=r;return L(t,function(t){var e=o(z);e<u+1&&0>t.delta||e>l-1&&0<t.delta||(y+=.05*t.delta,S=i(z,y),clearTimeout(_),_=setTimeout(function(){y=1,z=s(S)},20))}),t.addEventListener("mousedown",function(i){E=A(t,i.clientX,i.clientY),t.addEventListener("mousemove",d,!1),t.addEventListener("mouseup",c,!1),t.addEventListener("mouseout",c,!1)},!1),function(){return S}}function C(e){return{position:[-e,0,-e,-e,0,e,e,0,-e,e,0,-e,-e,0,e,e,0,e,e,0,-e,-e,0,e,-e,0,-e,e,0,e,-e,0,e,e,0,-e],normal:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],texcoord:[0,1,0,0,1,1,1,1,0,0,1,0,1,1,0,0,0,1,1,0,0,0,1,1]}}function N(t){var i=t[0],r=t[1],n=t[2],e=ge(i*i+r*r+n*n);return e?1==e?t:(e=1/e,t[0]=i*e,t[1]=r*e,t[2]=n*e,t):(t[0]=0,t[1]=0,t[2]=0,t)}function I(e){return Ze[e].bindPoint}function O(e,t){return function(i){e.uniform1i(t,i)}}function F(e,t){return function(i){e.uniform1iv(t,i)}}function B(e,t){return function(i){e.uniform2iv(t,i)}}function V(e,t){return function(i){e.uniform3iv(t,i)}}function P(e,t){return function(i){e.uniform4iv(t,i)}}function D(e,t,i,r){const n=I(t);return W(e)?function(t){let o,a;X(e,t)?(o=t,a=null):(o=t.texture,a=t.sampler),e.uniform1i(r,i),e.activeTexture(e.TEXTURE0+i),e.bindTexture(n,o),e.bindSampler(i,a)}:function(t){e.uniform1i(r,i),e.activeTexture(e.TEXTURE0+i),e.bindTexture(n,t)}}function w(e,t,r,n,o){const a=I(t),s=new Int32Array(o);for(let a=0;a<o;++a)s[a]=r+a;return W(e)?function(t){e.uniform1iv(n,s),t.forEach(function(t,i){e.activeTexture(e.TEXTURE0+s[i]);let n,o;X(e,t)?(n=t,o=null):(n=t.texture,o=t.sampler),e.bindSampler(r,o),e.bindTexture(a,n)})}:function(t){e.uniform1iv(n,s),t.forEach(function(t,i){e.activeTexture(e.TEXTURE0+s[i]),e.bindTexture(a,t)})}}function M(e,t){return function(i){i.value?(e.disableVertexAttribArray(t),e.vertexAttrib4fv(t,i.value)):(e.bindBuffer(e.ARRAY_BUFFER,i.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,i.num||i.size,i.type||e.FLOAT,i.normalize||!1,i.stride||0,i.offset||0),i.divisor!==void 0&&e.vertexAttribDivisor(t,i.divisor))}}function U(e,t){return function(i){i.value?(e.disableVertexAttribArray(t),e.vertexAttrib4iv(t,i.value)):(e.bindBuffer(e.ARRAY_BUFFER,i.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,i.num||i.size,i.type||e.INT,i.stride||0,i.offset||0),i.divisor!==void 0&&e.vertexAttribDivisor(t,i.divisor))}}function G(e,t){return function(i){i.value?(e.disableVertexAttribArray(t),e.vertexAttrib4uiv(t,i.value)):(e.bindBuffer(e.ARRAY_BUFFER,i.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,i.num||i.size,i.type||e.UNSIGNED_INT,i.stride||0,i.offset||0),i.divisor!==void 0&&e.vertexAttribDivisor(t,i.divisor))}}function k(e,t,i){const r=i.size,n=i.count;return function(o){e.bindBuffer(e.ARRAY_BUFFER,o.buffer);const a=o.size||o.num||r,s=o.type||e.FLOAT,u=Ze[s],l=u.size*a,d=o.normalize||!1,c=o.offset||0;for(let r=0;r<n;++r)e.enableVertexAttribArray(t+r),e.vertexAttribPointer(t+r,a/n,s,d,l,c+l/n*r),void 0!==o.divisor&&e.vertexAttribDivisor(t+r,o.divisor)}}function X(e,i){return tt||(tt=e.createTexture()),i instanceof tt.constructor}function W(e){return!!e.texStorage2D}function Y(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}function H(e,t){rt(e,0);const i=e.getExtension(t);if(i){const r={},n=nt.exec(t)[1];for(const t in i){const o=i[t],a="function"==typeof o,s=a?n:"_"+n;let u=t;t.endsWith(s)&&(u=t.substring(0,t.length-s.length)),e[u]===void 0?a?e[u]=function(e){return function(){return e.apply(i,arguments)}}(o):(e[u]=o,r[u]=o):!a&&e[u]!==o&&console.warn(u,e[u],o,t)}r.constructor={name:i.constructor.name},rt(r,0)}return i}function j(e){for(let t=0;t<it.length;++t)H(e,it[t])}function q(e,...t){const i=K(t);return J(e,i)}function K(...e){const t=[];let i,r,n;if((e+"").replace(/[^\,\s]+/g,function(e){e&&t.push(e)}),t.forEach(e=>{if(n=document.getElementById(e),!n)throw"unknown script element "+e;0<=n.type.indexOf("vert")?i=n.text:0<=n.type.indexOf("frag")&&(r=n.text)}),!i)throw"VERTEX_SHADER String not exist";if(!r)throw"FRAGMENT_SHADER String not exist";return[i,r]}function J(e,...t){Array.isArray(t[0])&&(t=t[0]);const i=Q(e,e.VERTEX_SHADER,t[0]),r=Q(e,e.FRAGMENT_SHADER,t[1]);if(!i)throw"VERTEX_SHADER not exist";if(!r)throw"FRAGMENT_SHADER not exist";const n=e.createProgram();if(!n)throw"program not exist";e.attachShader(n,i),e.attachShader(n,r),e.linkProgram(n);const o=e.getProgramParameter(n,e.LINK_STATUS);if(!o){const t=e.getProgramInfoLog(n);throw e.deleteProgram(n),e.deleteShader(r),e.deleteShader(i),"Failed to link program: "+t.toString()}return n}function Q(e,t,i){const r=e.createShader(t);if(!r)throw"unable to create shader";e.shaderSource(r,i),e.compileShader(r);const n=e.getShaderParameter(r,e.COMPILE_STATUS);if(!n){const t=e.getShaderInfoLog(r);throw e.deleteShader(r),"Failed to compile shader: "+t.toString()}return r}function Z(e,...t){Array.isArray(t[0])&&(t=t[0]);const i=0<t[0].indexOf("{")?J(e,t):q(e,t),r=ee(e,i),n=$(e,i);return{program:i,uniformSetters:r,attribSetters:n}}function $(e,t){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let o=0;o<n;++o){const i=e.getActiveAttrib(t,o);if(Y(i))continue;const n=e.getAttribLocation(t,i.name),a=$e[i.type],s=a.setter(e,n,a);s.location=n,r[i.name]=s}return r}function ee(e,t){function r(t,i){const r=e.getUniformLocation(t,i.name),o=1<i.size&&"[0]"===i.name.substr(-3),a=i.type,s=Ze[a];if(!s)throw"unknown type: 0x"+a.toString(16);let u;if(s.bindPoint){const t=n;n+=i.size,u=o?s.arraySetter(e,a,t,r,i.size):s.setter(e,a,t,r,i.size)}else u=s.arraySetter&&o?s.arraySetter(e,r):s.setter(e,r);return u.location=r,u}let n=0;const o={},a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<a;++n){const i=e.getActiveUniform(t,n);if(Y(i))continue;let a=i.name;"[0]"===a.substr(-3)&&(a=a.substr(0,a.length-3));const s=r(t,i);o[a]=s}return o}function te(e,t){e=e.uniformSetters||e,Object.keys(t).forEach(function(i){const r=e[i];r&&r(t[i])})}function ie(e,t,i){i.vertexArrayObject?e.bindVertexArray(i.vertexArrayObject):(re(t.attribSetters||t,i.attribs),i.indices&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.indices))}function re(e,t){e=e.attribSetters||e,Object.keys(t).forEach(function(i){const r=e[i];r&&r(t[i])})}function ne(e,t){const i={attribs:oe(e,t)};let r=t.indices;return r?(r=ue(r,"indices"),i.indices=ae(e,r,e.ELEMENT_ARRAY_BUFFER),i.count=r.length,i.indexType=de(r)):i.count=fe(t),i}function oe(e,t){const i={};return Object.keys(t).forEach(function(r){if(!ce(r)){const n=t[r],o=n.name||n.attribName||et.attribPrefix(r),a=ue(n,o);i[o]={buffer:ae(e,a,void 0,n.drawType),num:n.num||n.size||le(o),type:de(a),normalize:me(a),stride:n.stride||0,offset:n.offset||0,divisor:n.divisor,drawType:n.drawType||e.STATIC_DRAW}}}),e.bindBuffer(e.ARRAY_BUFFER,null),i}function ae(e,t,i,r){i=i||e.ARRAY_BUFFER;const n=e.createBuffer();return e.bindBuffer(i,n),e.bufferData(i,t,r||e.STATIC_DRAW),n}function se(e,t,i){const r=e.createVertexArray();return e.bindVertexArray(r),t.length||(t=[t]),t.forEach(function(t){ie(e,t,i)}),e.bindVertexArray(null),{count:i.count,indexType:i.indexType,vertexArrayObject:r}}function ue(e,t){if(_e(e))return e;if(_e(e.data))return e.data;Array.isArray(e)&&(e={data:e});let i=e.type;return i||(ce(t)?i=Uint16Array:i=Float32Array),new i(e.data)}function le(e,t){let i;if(i=ot.test(e)?2:at.test(e)?4:3,0<t%i)throw"Can not guess num for attribute '"+e+"'. Tried "+i+" but "+t+" values is not evenly divisible by "+i+". You should specify it.";return i}function de(e){if(e instanceof Int8Array)return Ce;if(e instanceof Uint8Array)return Ne;if(e instanceof Uint8ClampedArray)return Ne;if(e instanceof Int16Array)return Ie;if(e instanceof Uint16Array)return Oe;if(e instanceof Int32Array)return De;if(e instanceof Uint32Array)return qe;if(e instanceof Float32Array)return Fe;throw"unsupported typed array type"}function ce(e){return"indices"===e}function _e(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer}function me(e){return!!(e instanceof Int8Array)||!!(e instanceof Uint8Array)}function fe(e){let t,r;for(r=0;r<st.length&&(t=st[r],!(t in e));++r);r===st.length&&(t=Object.keys(e)[0]);const n=e[t],o=pe(n).length,a=he(n,t);if(0<o%a)throw"numComponents "+a+" not correct for length "+o;return o/a}function pe(e){return e.length?e:e.data}function he(e,t){return e.num||e.size||le(t,pe(e).length)}function ve(e,t,i,r,n){i=i||e.TRIANGLES,r=r||t.count,n=n||0;const o=t.indices,a=t.indexType;a||o?e.drawElements(i,r,a||Oe,n):e.drawArrays(i,n,r)}function xe(e){const t=ft.measureText(e.name).width;ft.save(),ft.fillStyle="hsla(0,0%,30%,1)",ft.fillRect(e.x-50,e.y-30,t+20,50),ft.restore(),ft.strokeRect(e.x-50,e.y-30,t+20,50),ft.fillText(e.name,e.x-40,e.y),ft.strokeText(e.name,e.x-40,e.y)}let Ae=Float32Array,Se=Float32Array;const ze=e(),Le=e(),Re=e(),Ce=5120,Ne=5121,Ie=5122,Oe=5123,Fe=5126,Be=35664,Ve=35665,Pe=35666,De=5124,we=35667,Me=35668,Ue=35669,Ge=35670,ke=35671,Xe=35672,We=35673,Ye=35674,He=35675,je=35676,qe=5125,Ke=36294,Je=36295,Qe=36296,Ze={};Ze[Fe]={Type:Float32Array,size:4,setter:function(e,t){return function(i){e.uniform1f(t,i)}},arraySetter:function(e,t){return function(i){e.uniform1fv(t,i)}}},Ze[Be]={Type:Float32Array,size:8,setter:function(e,t){return function(i){e.uniform2fv(t,i)}}},Ze[Ve]={Type:Float32Array,size:12,setter:function(e,t){return function(i){e.uniform3fv(t,i)}}},Ze[Pe]={Type:Float32Array,size:16,setter:function(e,t){return function(i){e.uniform4fv(t,i)}}},Ze[De]={Type:Int32Array,size:4,setter:O,arraySetter:F},Ze[we]={Type:Int32Array,size:8,setter:B},Ze[Me]={Type:Int32Array,size:12,setter:V},Ze[Ue]={Type:Int32Array,size:16,setter:P},Ze[qe]={Type:Uint32Array,size:4,setter:function(e,t){return function(i){e.uniform1ui(t,i)}},arraySetter:function(e,t){return function(i){e.uniform1uiv(t,i)}}},Ze[Ke]={Type:Uint32Array,size:8,setter:function(e,t){return function(i){e.uniform2uiv(t,i)}}},Ze[Je]={Type:Uint32Array,size:12,setter:function(e,t){return function(i){e.uniform3uiv(t,i)}}},Ze[Qe]={Type:Uint32Array,size:16,setter:function(e,t){return function(i){e.uniform4uiv(t,i)}}},Ze[Ge]={Type:Uint32Array,size:4,setter:O,arraySetter:F},Ze[ke]={Type:Uint32Array,size:8,setter:B},Ze[Xe]={Type:Uint32Array,size:12,setter:V},Ze[We]={Type:Uint32Array,size:16,setter:P},Ze[Ye]={Type:Float32Array,size:16,setter:function(e,t){return function(i){e.uniformMatrix2fv(t,!1,i)}}},Ze[He]={Type:Float32Array,size:36,setter:function(e,t){return function(i){e.uniformMatrix3fv(t,!1,i)}}},Ze[je]={Type:Float32Array,size:64,setter:function(e,t){return function(i){e.uniformMatrix4fv(t,!1,i)}}},Ze[35685]={Type:Float32Array,size:24,setter:function(e,t){return function(i){e.uniformMatrix2x3fv(t,!1,i)}}},Ze[35686]={Type:Float32Array,size:32,setter:function(e,t){return function(i){e.uniformMatrix2x4fv(t,!1,i)}}},Ze[35687]={Type:Float32Array,size:24,setter:function(e,t){return function(i){e.uniformMatrix3x2fv(t,!1,i)}}},Ze[35688]={Type:Float32Array,size:48,setter:function(e,t){return function(i){e.uniformMatrix3x4fv(t,!1,i)}}},Ze[35689]={Type:Float32Array,size:32,setter:function(e,t){return function(i){e.uniformMatrix4x2fv(t,!1,i)}}},Ze[35690]={Type:Float32Array,size:48,setter:function(e,t){return function(i){e.uniformMatrix4x3fv(t,!1,i)}}},Ze[35678]={Type:null,size:0,setter:D,arraySetter:w,bindPoint:3553},Ze[35680]={Type:null,size:0,setter:D,arraySetter:w,bindPoint:34067},Ze[35679]={Type:null,size:0,setter:D,arraySetter:w,bindPoint:32879},Ze[36289]={Type:null,size:0,setter:D,arraySetter:w,bindPoint:35866};const $e={};$e[Fe]={size:4,setter:M},$e[Be]={size:8,setter:M},$e[Ve]={size:12,setter:M},$e[Pe]={size:16,setter:M},$e[De]={size:4,setter:U},$e[we]={size:8,setter:U},$e[Me]={size:12,setter:U},$e[Ue]={size:16,setter:U},$e[qe]={size:4,setter:G},$e[Ke]={size:8,setter:G},$e[Je]={size:12,setter:G},$e[Qe]={size:16,setter:G},$e[Ge]={size:4,setter:U},$e[ke]={size:8,setter:U},$e[Xe]={size:12,setter:U},$e[We]={size:16,setter:U},$e[Ye]={size:4,setter:k,count:2},$e[He]={size:9,setter:k,count:3},$e[je]={size:16,setter:k,count:4};const et={addExtensionsToContext:!0,attribPrefix:e=>"a"+e[0].toUpperCase()+e.substr(1)};let tt;const it=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"],rt=function(){function e(e){const r=e.constructor.name;if(!t[r]){for(const t in e)if("number"==typeof e[t]){const r=i[e[t]];i[e[t]]=r?`${r} | ${t}`:t}t[r]=!0}}const t={},i={};return function(t,r){return e(t),i[r]||"0x"+r.toString(16)}}(),nt=/^(.*?)_/,ot=/coord|texture/i,at=/color|colour/i,st=["position","positions","a_position"];const ut=document.getElementById("canvas"),lt=function(e,t){const r=["webgl","experimental-webgl"];let n=null;for(let o=0,i=r.length;o<i;o++)if(n=e.getContext(r[o],t),n){et.addExtensionsToContext&&j(n);break}return n}(ut),dt=[],ct=[function(e){e=e||1;var t=[-e,-e,-e,-e,e,-e,e,-e,-e,-e,e,-e,e,e,-e,e,-e,-e,-e,-e,e,e,-e,e,-e,e,e,-e,e,e,e,-e,e,e,e,e,-e,e,-e,-e,e,e,e,e,-e,-e,e,e,e,e,e,e,e,-e,-e,-e,-e,e,-e,-e,-e,-e,e,-e,-e,e,e,-e,-e,e,-e,e,-e,-e,-e,-e,-e,e,-e,e,-e,-e,-e,e,-e,e,e,-e,e,-e,e,-e,-e,e,e,-e,e,-e,e,e,-e,e,e,e,-e,e,e,e];return{position:t,normal:[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]}}(1),function(e,t){e=e||1,t=t||15;for(var n,o,a,s,u,d,c=[],_=[],m=[],f=0;f<=t;f++){s=f*be/t,d=e*Ee(s),o=e*ye(s);for(var p=0;p<=t;p++)u=2*p*be/t,n=Ee(u)*d,a=ye(u)*d,c.push(n,o,a)}for(f=0;f<t;f++)for(p=0;p<t;p++){var h=f*(t+1)+p,v=h+t+1;_.push(c[3*h],c[3*h+1],c[3*h+2]),_.push(c[3*v],c[3*v+1],c[3*v+2]),_.push(c[3*(h+1)],c[3*(h+1)+1],c[3*(h+1)+2]),_.push(c[3*(h+1)],c[3*(h+1)+1],c[3*(h+1)+2]),_.push(c[3*v],c[3*v+1],c[3*v+2]),_.push(c[3*(v+1)],c[3*(v+1)+1],c[3*(v+1)+2]),m=m.concat(N([c[3*h],c[3*h+1],c[3*h+2]])),m=m.concat(N([c[3*v],c[3*v+1],c[3*v+2]])),m=m.concat(N([c[3*(h+1)],c[3*(h+1)+1],c[3*(h+1)+2]])),m=m.concat(N([c[3*(h+1)],c[3*(h+1)+1],c[3*(h+1)+2]])),m=m.concat(N([c[3*v],c[3*v+1],c[3*v+2]])),m=m.concat(N([c[3*(v+1)],c[3*(v+1)+1],c[3*(v+1)+2]]))}return c=null,{position:_,normal:m}}(1,40),function(e,t,n){e=e||1,t=t||1,n=n||3;for(var o=[],a=[],s=[],u=2*be/n,d=0,c=e*e/t,_=0,m=3,f=0;f<n;f++)d=e*ye(u*f),_=e*Ee(u*f),o.push(d,-t/2,_);for(var f=0,p=o.length;f<p;f+=m){var v=(f+3)%p,T=(f+4)%p,E=(f+5)%p;a.push(0,t/2,0),a.push(o[v],o[T],o[E]),a.push(o[f],o[f+1],o[f+2]),s.push(0,1,0),s=s.concat(N([o[v],c,o[E]])),s=s.concat(N([o[f],c,o[f+2]])),a.push(0,-t/2,0),a.push(o[f],o[f+1],o[f+2]),a.push(o[v],o[T],o[E]),s.push(0,-1,0,0,-1,0,0,-1,0)}return o=null,{position:a,normal:s}}(1,3,20),function(e,t,n){e=e||1,t=t||1,n=n||3;for(var o=[],a=[],s=[],u=2*be/n,d=0,c=0,_=6,m=0;m<n;m++)d=e*ye(u*m),c=e*Ee(u*m),o.push(d,t/2,c),o.push(d,-t/2,c);for(var m=0,f=o.length;m<f;m+=_){var p=(m+6)%f,v=(m+7)%f,T=(m+8)%f,E=(m+9)%f,y=(m+10)%f,A=(m+11)%f;a.push(0,t/2,0),a.push(o[p],o[v],o[T]),a.push(o[m],o[m+1],o[m+2]),s.push(0,1,0,0,1,0,0,1,0),a.push(o[m],o[m+1],o[m+2]),a.push(o[p],o[v],o[T]),a.push(o[m+3],o[m+4],o[m+5]),s=s.concat(N([o[m],t/2,o[m+2]])),s=s.concat(N([o[p],t/2,o[T]])),s=s.concat(N([o[m+3],-t/2,o[m+5]])),a.push(o[m+3],o[m+4],o[m+5]),a.push(o[p],o[v],o[T]),a.push(o[E],o[y],o[A]),s=s.concat(N([o[m+3],-t/2,o[m+5]])),s=s.concat(N([o[p],t/2,o[T]])),s=s.concat(N([o[E],-t/2,o[A]])),a.push(0,-t/2,0),a.push(o[m+3],o[m+4],o[m+5]),a.push(o[E],o[y],o[A]),s.push(0,-1,0,0,-1,0,0,-1,0)}return o=null,{position:a,normal:s}}(1,2,20)],_t=["cube","sphere","cone","cylinder"],mt=document.getElementById("text"),ft=mt.getContext("2d"),pt=u(),ht=[1,.1,.1,1];mt.addEventListener("mousemove",function(t){const e=S(mt,t.clientX,t.clientY),r=[];if(dt.forEach((t,n)=>{t.select=!1,t.matrix=f(pt,t.pos);const i=ct[n%ct.length];let o,a,u,l;for(let e=0;e<i.position.length;e+=3){const r=v(t.matrix,i.position.slice(e,e+3));if(0==e){o=r[0],u=r[0],a=r[1],l=r[1];continue}r[0]>o&&(o=r[0]),r[0]<u&&(u=r[0]),r[1]>a&&(a=r[1]),r[1]<l&&(l=r[1])}e.x>=u&&e.x<=o&&e.y>=l&&e.y<=a&&r.push(t)}),!r.length)return;let i;i=1==r.length?r[0]:r.sort((e,t)=>{const i=v(e.matrix,[0,0,0])[2],r=v(t.matrix,[0,0,0])[2];return i-r})[0],dt[i.index].select=!0},!1),function(){if(!lt)return;const e=Z(lt,"#define GLSLIFY 1\nattribute vec4 aPosition;\nattribute vec4 aNormal;\nattribute vec2 aTexcoord;\nuniform mat4 u_vpMatrix;\nuniform mat4 u_modelMatrix;\nvarying vec3 v_normal;\nvarying vec3 v_position;\nvarying vec2 v_texcoord;\n\nvoid main() {\n  gl_Position = u_vpMatrix * u_modelMatrix * aPosition;\n  v_normal = vec3(u_modelMatrix * aNormal);\n  v_position= vec3(u_modelMatrix * aPosition);\n  v_texcoord = aTexcoord;\n}","precision mediump float;\n#define GLSLIFY 1\nuniform vec3 u_viewPosition;\nuniform vec3 u_lightPosition;\nuniform vec3 u_lightColor;\nuniform vec3 u_ambientColor;\nuniform vec3 u_specularColor;\nuniform float u_shininess;\nuniform vec4 u_color;\nvarying vec3 v_normal;\nvarying vec3 v_position;\n\nvoid main() {\n    vec3 normal = normalize(v_normal);\n    // \u73AF\u5883\u5149\n    vec3 ambient = u_ambientColor * u_color.rgb;\n    // \u5149\u7EBF\u65B9\u5411\n    vec3 lightDirection = normalize(u_lightPosition - v_position);\n    // \u5149\u7EBF\u65B9\u5411\u548C\u6CD5\u5411\u91CF\u5939\u89D2\n    float cosTheta = max(dot(lightDirection, normal), 0.0);\n    vec3 diffuse = u_lightColor * u_color.rgb * cosTheta;\n    \n    vec3 viewDirection = normalize(u_viewPosition - v_position);\n    vec3 halfwayDir = normalize(lightDirection + viewDirection);\n    float specularIntensity = pow(max(dot(normal, halfwayDir), 0.0), u_shininess);\n    vec3 specular = u_specularColor.rgb * specularIntensity;\n\n    gl_FragColor = vec4(ambient + diffuse + specular, u_color.a);\n}"),t=se(lt,e,ne(lt,C(30))),r=ct.map(t=>se(lt,e,ne(lt,t)));for(let e,t=0;8>t;t++)e=y(E(T())),e[3]=3<t?(t-3)/10:1,dt.push({index:t,pos:[9*Ee(2*(Math.random()*be)),5*ye(Math.random()*be/2)+2,5*Ee(2*(Math.random()*be))],color:e,name:_t[t%_t.length]+" "+t,select:!1});lt.clearColor(.1,.1,.1,1),lt.enable(lt.DEPTH_TEST),lt.enable(lt.CULL_FACE),z(ut),z(mt),lt.viewport(0,0,ut.width,ut.height),lt.useProgram(e.program);const n=R(mt,[0,9,15],1,50),o=c(be/3,ut.width/ut.height,.5,100);te(e,{u_lightPosition:[0,9,-15],u_lightColor:[1,1,1],u_ambientColor:[.8,.8,.8],u_specularColor:[1,1,1],u_shininess:20}),ft.font="28px arial",ft.lineWidth=2,ft.fillStyle="hsla(0,100%,100%,1)",ft.strokeStyle="hsla(0,100%,100%,0.7)",ft.lineCap="round",ft.lineJoin="round",function i(){const a=n(),s=l(_(a,[0,0,0],[0,1,0]));d(o,s,pt),lt.clear(lt.COLOR_BUFFER_BIT|lt.DEPTH_BUFFER_BIT),ft.clearRect(0,0,mt.width,mt.height),ie(lt,e,t),te(e,{u_viewPosition:a,u_vpMatrix:pt,u_modelMatrix:u(),u_specularColor:[.5,.5,.5],u_color:[.25,.25,.2,1]}),lt.depthMask(!0),lt.disable(lt.BLEND),ve(lt,t),dt.forEach((t,n)=>{const i=f(pt,t.pos),o=v(i,[0,1.8,0]),a=(.5*o[0]+.5)*lt.canvas.width,s=(-.5*o[1]+.5)*lt.canvas.height;t.select&&xe({x:a,y:s,name:t.name});const u=r[n%r.length];ie(lt,e,u),te(e,{u_modelMatrix:m(t.pos),u_color:t.select?ht:t.color}),4>n?(lt.depthMask(!0),lt.disable(lt.BLEND)):(lt.depthMask(!1),lt.enable(lt.BLEND),lt.blendFunc(lt.SRC_ALPHA,lt.ONE_MINUS_SRC_ALPHA)),ve(lt,u)}),lt.bindVertexArray(null),requestAnimationFrame(i)}()}()})();
