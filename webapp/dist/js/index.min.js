function createIndex(e,t){t.on("click","[data-hash]",function(){var e=$(this).attr("data-hash");e&&App.setPage(e)})}function createDialog(e,t){var a=$("#loading"),i=$("#freshing");t.find("[data-tag=loading]").on("click",function(){a.show(),loadPercent(30),setTimeout(function(){loadPercent(100)},2e3)}),t.find("[data-tag=freshing]").on("click",function(){i.show(),setTimeout(function(){i.hide()},2e3)})}!function(){function e(e){var t={container:document.body,pageFn:function(e,t,a){this.hash=e,this.temId=t||"",this.temUrl=a||"",this.active=!1,this.elem=$('<div class="view" hash="'+e+'"></div>')},animate:{effects:["slideInRight","slideOutLeft","slideInLeft","slideOutRight"],delay:510},preLoad:function(){},aftLoad:function(){}};$.extend(t,e),this.hashSplit="/",this.con="string"==typeof t.container?$("#"+t.container):t.container,this.pageFn=t.pageFn,this.animate=t.animate,this.preLoad=t.preLoad,this.aftLoad=t.aftLoad,this.firstLoad=!0,this.isLoading=!1,this.currHash="",this.lastHash="",this.pages={},this.view={},this.otherView={},this.request={},this.hashHistory=[],this.historyCurr=-1,this.isForward=!0}e.prototype={init:function(){var e=this;return $(window).on("hashchange",function(){e.load()}),e.load(),e},load:function(){var e=this,t=e.view,a=e.otherView,i="",n=[];return e.setRequestParam(),i=e.request.hash,n=e.request.args,t[i]?e.setPage(i,n):a.hash?e.setPage(a.hash,n):"function"==typeof a&&a.call(e),e},setPage:function(e,t){var a=this,i=[],n=a.hashSplit;return t=t||"",!this.isLoading&&((String(e)+","+String(t)).replace(new RegExp("[^\\,\\s\\"+n+"]+","g"),function(e){e&&i.push(e)}),i=n+i.join(n),location.hash.substr(1)==i?this.updatePage(e):location.hash=i,this)},updatePage:function(e){var t,a,i=this,n=i.pages,s=i.view[e],r=n[e],h=n[i.currHash],o=function(){a=[i,r.elem].concat(i.request.args),i.preLoad(),s.create.apply(s,a),s.init.apply(s,a),h?i.switchEffect(r,h,function(){i.aftLoad()}):(r.elem.show(),i.aftLoad())};if(i.isLoading)return!1;if(r&&(a=[i,r.elem].concat(i.request.args)),r)h.hash!==e?(i.firstLoad=!1,i.currHash=e,i.lastHash=h.hash,i.bulidArgs(),i.preLoad(),s.init.apply(s,a),i.switchEffect(r,h,function(){i.aftLoad()})):(i.bulidArgs(),s.isParamChange&&s.init.apply(s,a));else{for(t in n){i.firstLoad=!1;break}r=new i.pageFn(e,s.temId,s.temUrl),n[e]=r,r.active=!0,i.currHash=e,i.bulidArgs(),r.temId?(r.elem.html($("#"+r.temId).html()),o()):r.temUrl&&$.ajax({url:r.temUrl,type:"GET",dataType:"html",async:!0,success:function(e){r.elem.html(e),o()}}),i.con.prepend(r.elem)}return i},pushHistory:function(){var e=this;e.hashHistory.push(e.currHash),history.pushState({lastHash:e.lastHash,currHash:e.currHash,param:e.args},document.title,location.href)},switchEffect:function(e,t,a){var i=this,n=i.isForward?i.animate.effects[0]:i.animate.effects[2],s=i.isForward?i.animate.effects[1]:i.animate.effects[3],r=i.animate.delay;return i.isLoading=!0,e.active=!0,t.active=!1,t.elem[0].className="view "+s,e.elem[0].className="view animate-start "+n,e.elem.show(),setTimeout(function(){t.elem[0].className="view",t.elem.hide(),e.elem[0].className="view",i.isLoading=!1,a()},r)},refresh:function(){var e=this,t=e.view[e.currHash],a=e.pages[e.currHash];return a&&t.init.apply(t,[e,a.elem].concat(e.request.args)),e},getHashArg:function(e){var t=e||location.hash.replace("#",""),a=this.hashSplit,i=null,n=new RegExp("\\"+a+"([^\\"+a+"]*)","g"),s=[];if(t.indexOf(a)>-1)for(;i=n.exec(t);)s.push(i[1]);return{hash:s.shift()||"",args:s}},setRequestParam:function(){return $.extend(this.request,this.getHashArg()),this},bulidArgs:function(){var e=this,t=e.view[e.currHash],a=t.args||[],i=e.request.args||[],n=a.length;t.isParamChange=!1,e.args={};for(var s=0;s<n;s++)e.args[a[s]]=i[s],t.param[a[s]]&&t.param[a[s]]!=i[s]&&(t.isParamChange=!0),t.param[a[s]]=i[s];return e},when:function(e,t){var a=this.hashView(e,t);return this.view[a.hash]=a,this},other:function(e,t){if("function"==typeof e)return this.otherView=e,this;var a=this.hashView(e,t);return a.hash&&(this.view[a.hash]=a),this.otherView=a,this},hashView:function(e,t){return $.extend({temId:"",temUrl:"",param:{},isParamChange:!1,create:function(){},init:function(){}},t,this.getHashArg(e))}},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return function(t){return new e(t)}}):"undefined"!=typeof module&&module.exports?module.exports.webApp=function(t){return new e(t)}:window.webApp=function(t){return new e(t)}}();var App=webApp({container:"app",animate:{effects:["slideInRight","slideOutLeft"],delay:600},preLoad:function(){},aftLoad:function(){loadPercent(100)}}).other("/index",{temId:"tempIndex",create:createIndex}).when("/button",{temId:"tempButton"}).when("/dialog",{temId:"tempDialog",create:createDialog}).when("/form",{temId:"tempForm"}).init();